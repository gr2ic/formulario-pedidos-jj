
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Pedido</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f5f5f5; padding: 20px; }
        .container { max-width: 700px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; }
        h2 { text-align: center; color: #222; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 6px; margin-top: 4px; box-sizing: border-box; }
        .item { margin-bottom: 15px; }
        .button { padding: 10px 20px; background: #000; color: white; cursor: pointer; border: none; margin-top: 20px; }
        .button:hover { background: #333; }
        #logo { width: 100px; display: block; margin: auto; }
    </style>
</head>
<body>
    <div class="container">
        <img id="logo" src="https://drive.google.com/uc?export=view&id=1ujyK_6uZcn0ZnIJP03J266gBbSMTCKDS" alt="Logo J&J">
        <h2>Cadastro de Pedido</h2>

        <form id="pedidoForm">
            <label>Data do Pedido:
                <input type="date" name="data_pedido" required />
            </label>

            <label>Vendedor:
                <select name="vendedor" required>
                    <option value="">Selecione</option>
                    <option>Thalyson</option>
                    <option>Geilson</option>
                </select>
            </label>

            <label>CNPJ do Cliente:
                <input type="text" id="cnpj" name="cnpj" required />
                <button type="button" onclick="buscarCNPJ()">Buscar Cliente</button>
            </label>

            <label>Razão Social:
                <input type="text" id="razao" name="razao_social" readonly />
            </label>

            <label>Nome Fantasia:
                <input type="text" id="fantasia" name="nome_fantasia" readonly />
            </label>

            <label>Endereço:
                <input type="text" id="endereco" name="endereco" readonly />
            </label>

            <label>Município:
                <input type="text" id="municipio" name="municipio" readonly />
            </label>

            <label>UF:
                <input type="text" id="uf" name="uf" readonly />
            </label>

            <div id="itens">
                <div class="item">
                    <label>Produto:
                        <select name="produto[]">
                            <option value="1 - Realengo TP 1 6x5 Parboilizado">1 - Realengo TP 1 6x5 Parboilizado</option>
                            <option value="3 - Realengo TP 1 30x1 Parboilizado">3 - Realengo TP 1 30x1 Parboilizado</option>
                            <option value="642 - Realengo 10x6 6x5">642 - Realengo 10x6 6x5</option>
                        </select>
                    </label>

                    <label>Quantidade:
                        <input type="number" name="quantidade[]" required />
                    </label>

                    <label>Preço Unitário:
                        <input type="number" name="preco[]" step="0.01" required />
                    </label>
                </div>
            </div>

            <button type="button" onclick="adicionarItem()">+ Adicionar Produto</button>

            <label>Condição de Pagamento:
                <select name="condicao_pagamento" required>
                    <option value="AVISTA ANTECIPADO">AVISTA ANTECIPADO</option>
                    <option value="30 DIAS">30 DIAS</option>
                </select>
            </label>

            <label>Formato de Entrega:</label>
            <label><input type="radio" name="formato_entrega" value="CIF" required /> CIF</label>
            <label><input type="radio" name="formato_entrega" value="FOB" /> FOB</label>

            <label>Observações:
                <textarea name="observacoes"></textarea>
            </label>

            <button class="button" type="submit">Enviar Pedido</button>
        </form>
    </div>

    <script>
        async function buscarCNPJ() {
            const cnpj = document.getElementById("cnpj").value.replace(/\D/g, "");
            const res = await fetch(`https://brasilapi.com.br/api/cnpj/v1/${cnpj}`);
            const data = await res.json();
            document.getElementById("razao").value = data.razao_social || "";
            document.getElementById("fantasia").value = data.nome_fantasia || "";
            document.getElementById("endereco").value = (data.logradouro || "") + ", " + (data.numero || "") + " - " + (data.bairro || "");
            document.getElementById("municipio").value = data.municipio || "";
            document.getElementById("uf").value = data.uf || "";
        }

        function adicionarItem() {
            const container = document.getElementById("itens");
            const item = document.createElement("div");
            item.className = "item";
            item.innerHTML = `
                <label>Produto:
                    <select name="produto[]">
                        <option value="1 - Realengo TP 1 6x5 Parboilizado">1 - Realengo TP 1 6x5 Parboilizado</option>
                        <option value="3 - Realengo TP 1 30x1 Parboilizado">3 - Realengo TP 1 30x1 Parboilizado</option>
                        <option value="642 - Realengo 10x6 6x5">642 - Realengo 10x6 6x5</option>
                    </select>
                </label>
                <label>Quantidade:
                    <input type="number" name="quantidade[]" required />
                </label>
                <label>Preço Unitário:
                    <input type="number" name="preco[]" step="0.01" required />
                </label>`;
            container.appendChild(item);
        }

        document.getElementById("pedidoForm").addEventListener("submit", async function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const res = await fetch("https://script.google.com/macros/s/AKfycbzvEeln2NhLY31ZL4LF5X6PJ48dzBn1B0hXBPy23vNrHeIEeyH1_hTCd_pqcdMa7ELU-g/exec", {
                method: "POST",
                body: new URLSearchParams(formData)
            });
            alert("Pedido enviado com sucesso!");
            this.reset();
        });
    </script>
</body>
</html>
