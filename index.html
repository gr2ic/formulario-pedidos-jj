<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cadastro de Pedido - J&J</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      padding: 10px;
      margin: 0;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px #ccc;
    }
    h2 {
      text-align: center;
      margin-top: 0;
    }
    label {
      display: block;
      margin: 12px 0 5px;
      font-weight: bold;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      box-sizing: border-box;
    }
    .produto {
      display: flex;
      gap: 5px;
      margin-bottom: 8px;
    }
    .produto select, .produto input {
      flex: 1;
    }
    .produto button {
      width: auto;
      padding: 4px 8px;
      background: #d9534f;
      color: white;
      border: none;
      border-radius: 4px;
    }
    .add-btn {
      background: #5cb85c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      margin-top: -5px;
      margin-bottom: 15px;
    }
    .submit-btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
    }
    img.logo {
      display: block;
      margin: 0 auto 10px;
      max-height: 50px;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://drive.google.com/uc?id=1e3Od-8Q_GpD7UudMzmWmPzUrKQFz5lz9" alt="Logo J&J" class="logo">
    <h2>Cadastro de Pedido</h2>
    <form id="pedidoForm">
      <label for="dataPedido">Data do Pedido:</label>
      <input type="date" name="dataPedido" required>

      <label for="vendedor">Vendedor:</label>
      <select name="vendedor" required>
        <option value="">Selecione</option>
        <option>Thalyson</option>
        <option>Moises</option>
        <option>Rafael</option>
        <option>Wilian</option>
        <option>Flaviano</option>
      </select>

      <label for="cnpj">CNPJ do Cliente:</label>
      <input type="text" name="cnpj" required>

      <label for="razaoSocial">Raz√£o Social:</label>
      <input type="text" name="razaoSocial" required>

      <label for="nomeFantasia">Nome Fantasia:</label>
      <input type="text" name="nomeFantasia">

      <label for="endereco">Endere√ßo:</label>
      <input type="text" name="endereco">

      <label for="municipio">Munic√≠pio:</label>
      <input type="text" name="municipio">

      <label for="uf">UF:</label>
      <input type="text" name="uf">

      <label>Produtos:</label>
      <div id="produtosContainer">
        <div class="produto">
          <select name="produto" required>
            <option value="">Selecione</option>
            <option>1 - Realengo TP 1 6x5 Parboilizado</option>
            <option>3 - Realengo TP 1 30x1 Parboilizado</option>
            <option>642 - Realengo Polido 6x5</option>
            <option>643 - Realengo Polido 30x1</option>
            <option>1110 - Arroz P/ C√£es 6x5</option>
            <option>8291 - Arroz Parboilizado 25Kg TP 1</option>
            <option>8295 - Arroz Polido TP 1 SC 25Kg</option>
            <option>1128 - Realengo TP 1 SC 50Kg Parboilizado</option>
            <option>1200 - Realengo TP 1 SC 50Kg Polido</option>
            <option>8899 - Arroz Realengo Integral 10x1</option>
            <option>13 - Realengo Parboilizado TP 1 - 10x1</option>
            <option>8151 - Arroz Realengo Branco 10x1</option>
          </select>
          <input type="number" placeholder="Quantidade" required>
          <input type="number" placeholder="Pre√ßo Unit√°rio" required>
        </div>
      </div>
      <button type="button" class="add-btn" onclick="adicionarProduto()">+ Adicionar Produto</button>

      <label for="condicaoPagamento">Condi√ß√£o de Pagamento:</label>
      <select name="condicaoPagamento" required>
        <option>AVISTA ANTECIPADO</option>
        <option>BOLETO 7 DIAS</option>
        <option>BOLETO 14 /21 DIAS</option>
        <option>BOLETO 14 / 21 / 28 DIAS</option>
        <option>BOLETO 14 / 21 / 28 / 35 DIAS</option>
        <option>BOLETO 14 / 21 / 28 / 35 / 42 DIAS</option>
        <option>BOLETO 21 / 28 / 35 DIAS</option>
        <option>BOLETO 21 / 28 / 35 / 42 DIAS</option>
        <option>BOLETO 21 / 28 DIAS</option>
        <option>BOLETO 21 / 28 / 35 / 42 / 49 DIAS</option>
        <option>BOLETO 35 DIAS</option>
      </select>

      <label for="formatoEntrega">Formato de Entrega:</label>
      <label><input type="radio" name="formatoEntrega" value="CIF" required> CIF</label>
      <label><input type="radio" name="formatoEntrega" value="FOB"> FOB</label>

      <label for="observacoes">Observa√ß√µes:</label>
      <textarea name="observacoes" rows="3"></textarea>

      <button type="submit" class="submit-btn">Enviar Pedido</button>
    </form>
  </div>

  <script>
    function adicionarProduto() {
      const container = document.getElementById('produtosContainer');
      const div = document.createElement('div');
      div.className = 'produto';
      div.innerHTML = `
        <select name="produto" required>
          ${document.querySelector('[name="produto"]').innerHTML}
        </select>
        <input type="number" placeholder="Quantidade" required>
        <input type="number" placeholder="Pre√ßo Unit√°rio" required>
        <button type="button" onclick="this.parentElement.remove()">üóëÔ∏è</button>
      `;
      container.appendChild(div);
    }

    document.getElementById('pedidoForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const form = e.target;
      const produtos = [...form.querySelectorAll('.produto')].map(p => ({
        nome: p.children[0].value,
        quantidade: p.children[1].value,
        precoUnitario: p.children[2].value
      }));

      const payload = {
        dataPedido: form.dataPedido.value,
        vendedor: form.vendedor.value,
        cnpj: form.cnpj.value,
        razaoSocial: form.razaoSocial.value,
        nomeFantasia: form.nomeFantasia.value,
        endereco: form.endereco.value,
        municipio: form.municipio.value,
        uf: form.uf.value,
        condicaoPagamento: form.condicaoPagamento.value,
        formatoEntrega: form.formatoEntrega.value,
        observacoes: form.observacoes.value,
        produtos
      };

      try {
        const res = await fetch('https://script.google.com/macros/s/AKfycbzvEeln2NhLY31ZL4LF5X6PJ48dzBn1B0hXBPy23vNrHeIEeyH1_hTCd_pqcdMa7ELU-g/exec', {
          method: 'POST',
          body: JSON.stringify(payload)
        });

        const result = await res.json();
        if (result.success) {
          alert('Pedido enviado com sucesso!');
          form.reset();
          document.getElementById('produtosContainer').innerHTML = '';
          adicionarProduto();
        } else {
          alert('Erro ao enviar pedido.');
        }
      } catch (err) {
        alert('Erro de conex√£o ao enviar o pedido.');
        console.error(err);
      }
    });

    window.addEventListener('DOMContentLoaded', () => adicionarProduto());
  </script>
</body>
</html>
